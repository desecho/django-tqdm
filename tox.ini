[tox]
envlist = py{35,36,37,38,39}-{pylint,flake8,isort,rstlint,pydiatra,pydocstyle,safety,pytest,black,shfmt,shellcheck}
skipsdist = True

[testenv]
usedevelop=True
setenv =
    PYTHONPATH = {toxinidir}
deps = -r{toxinidir}/requirements-dev.txt
sitepackages = false
envdir =
    py35: {toxworkdir}/py35
    py36: {toxworkdir}/py36
    py37: {toxworkdir}/py37
    py38: {toxworkdir}/py38
    py39: {toxworkdir}/py39
allowlist_externals =
    make
    echo
    shfmt
commands =
    requirements: echo "Install requirements"
    flake8: flake8 django_tqdm
    pylint: pylint django_tqdm
    pydiatra: make pydiatra
    isort: isort --check-only --diff django_tqdm
    bandit: bandit -r django_tqdm --exclude django_tqdm/tests
    pydocstyle: pydocstyle --match=".*\.py" django_tqdm --count
    safety: safety check
    pytest: py.test --cov-report term-missing --cov django_tqdm --verbose
    rstlint: rst-lint README.rst
    black: black . --check
    shfmt: shfmt -l -d .
    shellcheck: make shellcheck
